【最終要件定義書 ver.Final】
1. アプリ概要
アプリ名（案）: PlanLike, GoLike, LikeTrip
コンセプト: 「みんなの『好き』を、AIがひとつの物語（プラン）にする。」
コア体験: 友人や恋人と「ここ良くない？」と感じた瞬間のスクリーンショットを、グループ専用の「広場」に投げ合う。AIがそれらの画像から「みんなの今の気分」を読み取り、特別な名前のついた複数のルートプランを提案する。
ターゲットユーザー: 高校生、大学生、20代。タイムパフォーマンスを重視しつつ、「自分たちらしさ」を求める層。
2. 機能要件
2.1. ユーザー認証・グループ基盤
認証: Supabase Authを利用したメールアドレス/パスワードによるアカウント作成・ログイン機能。
プロフィール: ユーザー名とアバター画像を設定できる。
広場（グループ）機能:
ユーザーは目的別（例：「今週末の渋谷」「卒業旅行」）に複数の「広場」を作成・管理できる。
広場の作成者は、他のユーザーをアカウント名で検索して招待できる。
招待された側は承認・拒否を選択でき、承認するとメンバーになる。
2.2. 「LIKE」投稿機能
入力方法: スマートフォンのフォトライブラリからスクリーンショット画像をアップロードする。
理由: URLをコピー＆ペーストする手間を省き、ユーザーの日常的な行動（スクショ）をそのままアプリ体験に繋げるため。
表示: 投稿された画像は「広場」のタイムラインに一覧表示され、誰がどの画像を投稿したかが直感的にわかる。
リアクション: 各画像に対して、簡単なリアクション（例: 👍）を付けられる。
2.3. AIプランニング機能
画像解析: AI (Gemini Vision) がアップロードされた複数の画像から、テキスト情報、ランドマーク、場所の雰囲気（例: エモい、賑やか、静か）を抽出する。
プラン生成: 抽出した情報と、ユーザーが任意で入力する追加要望（予算、時間、食べたいもの等）を統合し、コンセプトの異なる3つのルートプランを生成する。
プラン・ネーミング: AIが各プランにキャッチーな名前を付与する。（例: 「100%映える。最先端トレンド追求コース」「予算3000円！節約しつつ満足チルコース」）
2.4. 共有・決定機能
プラン選択: AIが提案した3つのプランの中から、グループで話し合い、実行するプランを1つ選択する。
共有リンク: 決定したプランの詳細を確認できる専用ページのURLを発行し、LINE等の外部アプリで共有可能にする。
3. 技術要件
3.1. 全体アーキテクチャ
フロントエンド: React Native (Expo)
バックエンド: Supabase (Database, Auth, Storage)
AIオーケストレーション: Dify Cloud
LLM: Google Gemini (1.5 Pro / Flash) - Vision機能活用
3.2. データベース (Supabase/PostgreSQL)
設計: profiles, hirobas, hiroba_members (中間テーブル), posts, plans の5つのテーブルで構成。ユーザーと広場の「多対多」の関係を中間テーブルで適切に管理する。
型定義: Supabase CLIを用いてDBスキーマからTypeScriptの型を自動生成し、これを「信頼できる唯一の情報源」としてアプリ全体で利用する。
3.3. フロントエンドアーキテクチャ (React Native)
状態管理:
サーバー状態: TanStack Query (React Query) に一任する。APIからのデータ取得、キャッシュ、重複リクエスト防止を自動化し、useState + useEffect による手動でのデータ取得は原則禁止する。
クライアント状態: フォーム入力値やモーダルの開閉など、UI起因の状態管理には useState を使用する。
グローバル状態: 認証情報など、アプリ全体で共有するクライアント状態は React Context で管理する。
ディレクトリ構成: src ディレクトリ配下に api, components, hooks, screens, types などを機能的に配置し、コードの可読性と保守性を高める。
4. 開発ロードマップ（優先順位）
Phase 1 (MVP):
ユーザー認証機能。
単一の広場内で、画像を1枚アップロードできる。
アップロードされた1枚の画像情報を含む、「名前付きプラン」が1つ生成・表示される。
目標: アプリの最もコアな価値である「画像からプランが生成される」体験を最速で実現する。
Phase 2:
複数ユーザーが参加できるグループ（広場）機能の実装。
複数の画像から情報を統合してプランを生成するロジックの実装。
Phase 3:
AIが3案のプランを提示する機能。
プラン選択・共有機能の実装。
UI/UXの全体的なブラッシュアップ。